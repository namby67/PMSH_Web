@* <link href="~/css/pages/reservation.css" rel="stylesheet" asp-append-version="true" /> *@

<div class="header" style="justify-content:space-between;border-bottom:none">
    <div class="header2">
        <h3 id="content-title">
            Folio VAT Search

        </h3>
        <i class="fas fa-info-circle info-icon" title="How to use?"></i>
    </div>


</div>
<div class="mb-2">
    <div class="mui-card">
        <div class="header" style="justify-content:space-between">
            <div class="header2">
                <i class="fa-solid fa-sliders" style="background-color:#2b6cb0;color:white;padding:4px"></i>

                <h3 id="content-title">
                    Filter

                </h3>

            </div>

            <div class="header2">
                <i class="fa-solid fa-magnifying-glass" onclick="searchReservation()"></i>

            </div>
        </div>

        <div id="filter" class="tab-pane ">
            <div class="row">
                <div class="form-group-new-reservation col-md-1">
                    <label>From Date</label>
                    <input type="date" id="fromDate">
                </div>
                <div class="form-group-new-reservation col-md-1">
                    <label>To Date</label>
                    <input type="date" id="toDate">
                </div>



                <div class="form-group-new-reservation col-md-2">
                    <label>Folio Status</label>
                    <select id="folioStatus">
                        <option value="-1" selected>All</option>
                        <option value="0">Open</option>
                        <option value="1">Closed</option>
                    </select>
                </div>
                <div class="form-group-new-reservation col-md-2">
                    <label>Print Status</label>
                    <select id="printStatus">
                        <option value="-1">All</option>
                        <option value="1" selected>Printed</option>
                        <option value="0">Not Print</option>
                    </select>
                </div>


            </div>
        </div>
    </div>
</div>
<div id="gridContainer" class="gridContainer mt-2"></div>
<script>
    $(document).ready( function () {
        const today = new Date().toISOString().split('T')[0];

        // Set default values for From Date and To Date
        $('#fromDate').val(today);
        $('#toDate').val(today);
        searchReservation();
    });


    function searchReservation() {

        $.ajax({
            url: '/Cashiering/SearchFolioVAT',
            type: 'get',
            dataType: 'json',
            data: {
                fromDate: $('#fromDate').val(),
                toDate: $('#toDate').val(),
                folioStatus: $('#folioStatus').val(),
                printStatus: $('#printStatus').val(),
            },
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                console.log(result);
                initializeDataGridBilling(result);
            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                }
            },

        });

    }
    function initializeDataGridBilling(data) {

        $("#gridContainer").dxDataGrid({
            dataSource: data,
            keyExpr: "id", // Khóa chính của grid là id
            allowColumnResizing: true,

            paging: { pageSize: 15 },
            scrolling: {
                rowRenderingMode: 'virtual'
            },
            pager: {
                visible: true,
                allowedPageSizes: [15, 20, 'all'],
                showPageSizeSelector: true,
                showInfo: true,
                showNavigationButtons: true
            },
            filterRow: {
                visible: true,
                applyFilter: "auto"
            },
            selection: {
                mode: "multiple",
                showCheckBoxesMode: "always"
            },

        });
    }
</script>