@{
    ViewData["Title"] = "Home Page";
}

<style>
    .note-textarea {
        height: 160px;
    }

    .ts-wrapper .ts-control {
        margin: 0 0 0 -8px !important;
        padding: 0px 0px 0px 5px !important;
    }

    .nav-link {
        color: #009444 !important;
    }

    /* Ensure modals scroll correctly */
    .gridContainer {
        min-height: 200px;
    }

    .mui-card {
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1) !important;
    }
</style>

@await Html.PartialAsync("~/Views/Profile/NewProfileModal/_ProfileIndividual.cshtml")
@await Html.PartialAsync("~/Views/Profile/NewProfileModal/_ProfileCompany.cshtml")
@await Html.PartialAsync("~/Views/Profile/NewProfileModal/_ProfileGroup.cshtml")
@await Html.PartialAsync("~/Views/Profile/NewProfileModal/_ProfileContact.cshtml")

<div class="modal fade bd-example-modal-sm" id="profileTypeModal" tabindex="-1" role="dialog"
    aria-labelledby="profileTypeModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="profileTypeModalLabel">Choose Profile Type</h5>
            </div>
            <div class="modal-body p-2">
                <div class="form-check d-block">
                    <input class=" " type="radio" name="inlineRadioOptions" id="inlineRadio1" value="0" checked>
                    <label class="form-check-label" for="inlineRadio1"><b>Individual</b></label>
                </div>
                <div class="form-check d-block">
                    <input class=" " type="radio" name="inlineRadioOptions" id="inlineRadio2" value="2">
                    <label class="form-check-label" for="inlineRadio2"><b>Company</b></label>
                </div>
                <div class="form-check d-block">
                    <input class=" " type="radio" name="inlineRadioOptions" id="inlineRadio3" value="1">
                    <label class="form-check-label" for="inlineRadio3"><b>Travel Agent</b></label>
                </div>
                <div class="form-check d-block">
                    <input class=" " type="radio" name="inlineRadioOptions" id="inlineRadio4" value="3">
                    <label class="form-check-label" for="inlineRadio4"><b>Source</b></label>
                </div>
                <div class="form-check d-block">
                    <input class="" type="radio" name="inlineRadioOptions" id="inlineRadio5" value="4">
                    <label class="form-check-label" for="inlineRadio5"><b>Group</b></label>
                </div>
                <div class="form-check d-block">
                    <input class=" " type="radio" name="inlineRadioOptions" id="inlineRadio6" value="5">
                    <label class="form-check-label" for="inlineRadio6"><b>Contract</b></label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="mui-button mui-button-new" data-dismiss="modal"
                    onclick="$('#profileTypeModal').modal('hide');">Close</button>
                <button type="button" class="mui-button mui-button-new" onclick="chooseProfileType();">OK</button>
            </div>
        </div>
    </div>
</div>

<div id="loadingSpinner"
    style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); z-index:1000;">
    <i class="fa-solid fa-spinner fa-spin"></i>
</div>



<script>
    document.querySelectorAll('.profile-modal').forEach(modal => {
        modal.addEventListener('hidden.bs.modal', function () {
            closeFormProfile();
        });
    });
    function closeFormProfile() {
        resetForm();
        applyValidationErrors([], "#profile_individual");
        applyValidationErrors([], "#profile_com_ta_source");
        applyValidationErrors([], "#profile_group");
        applyValidationErrors([], "#profile_contact");
    }

    // Updated: Opens specific Modal based on type
    var profileTypeValue = 0;
    var profileTypeLabel = '';

    function chooseProfileType() {
        var radios = document.getElementsByName('inlineRadioOptions');
        for (var i = 0; i < radios.length; i++) {
            if (radios[i].checked) {
                profileTypeValue = radios[i].value;
                profileTypeLabel = document.querySelector('label[for="' + radios[i].id + '"]').innerText;

                $('#profileTypeModal').modal('hide');

                // Hide all first to be safe
                $('.profile-modal').modal('hide');

                if (profileTypeValue == '0') {
                    $('#modalProfileIndividual').modal('show');
                    $('#profile_individual').show(); // Ensure content is visible if logic relies on it
                    $('#btnView').show();
                }
                else if (profileTypeValue == '1' || profileTypeValue == '2' || profileTypeValue == '3') {
                    $('#modalProfileCompany').modal('show');
                    $('#profile_com_ta_source').show();
                    $('#btnView').hide();
                }
                else if (profileTypeValue == '4') {
                    $('#modalProfileGroup').modal('show');
                    $('#profile_group').show();
                    $('#btnView').hide();
                }
                else if (profileTypeValue == '5') {
                    $('#modalProfileContact').modal('show');
                    $('#profile_contact').show();
                    $('#btnView').hide();
                }
                return;
            }
        }
    }

    // Updated: Closes any open profile modal and shows choice
    function closeFormProfile() {
        $('.profile-modal').modal('hide');
        $('#profileTypeModal').modal('show');
        applyValidationErrors([], "#profile_individual");
        applyValidationErrors([], "#profile_com_ta_source");
        applyValidationErrors([], "#profile_group");
        applyValidationErrors([], "#profile_contact");
        resetForm();
    }

    if (document.getElementById('btnViewIndividual')) bindIndividualSearchButton();

    // --- IMAGE LOGIC ---
    function displaySelectedImage(event, elementId) {
        const selectedImage = document.getElementById(elementId);
        const fileInput = event.target;
        if (fileInput.files && fileInput.files[0]) {
            const reader = new FileReader();
            reader.onload = function (e) {
                selectedImage.src = e.target.result;
            };
            reader.readAsDataURL(fileInput.files[0]);
        }
    }

    // --- INITIALIZATION ---
    $(document).ready(async function () {
        getAllLanguage();
        getAllTitle();
        getAllNationality();
        getAllCountry();
        getAllState();
        getAllCity();
        getAllVIP();
        getPersonInCharge2();
        getAllOwner();
        getAllTerritory();
        getCompanyType();
        getCurrency();
        getMarketType();

        // Hide all modals initially
        $('.profile-modal').modal('hide');
        $('#profileTypeModal').modal('show');


    });

    // --- SAVE LOGIC (Original AJAX call preserved) ---
    async function saveProfile() {
        var formData = new FormData();
        formData.append('Type', profileTypeValue);

        if (profileTypeValue == 0) {
            const individualValid = await checkFullName({
                fullNameSelector: '#txtFullNameIndividual',
                firstNameSelector: '#txtFirstNameIndividual',
                middleNameSelector: '#txtMiddleNameIndividual',
                lastNameSelector: '#txtLastNameIndividual',
                salutationSelector: '#txtSalutationIndividual',
                titleSelector: '#txtTitleIndividual',
                idForm: "#profile_individual" // Note: This ID exists inside the modal
            });
            if (!individualValid) return;

            formData.append('ID', $("#idIndividual").val());
            formData.append('CodeIndividual', $("#txtCodeIndividual").val());
            formData.append('AccountIndividual', $("#txtFullNameIndividual").val());
            formData.append('LastNameIndivdual', $("#txtLastNameIndividual").val());
            formData.append('FirstNameIndividual', $("#txtFirstNameIndividual").val());
            formData.append('MiddleNameIndividual', $("#txtMiddleNameIndividual").val());
            formData.append('LanguageIndividual', $("#txtLanguageIndividual").val());
            formData.append('TitleIndividual', $("#txtTitleIndividual").val());
            formData.append('NationalityIndividual', $("#txtNationalityIndividual").val());
            formData.append('CountryIndividual', $("#txtCountryIndividual").val());
            formData.append('CityIndividual', $("#txtCityIndividual").val());
            formData.append('PostalIndividual', $("#txtPostalIndividual").val());
            formData.append('ReligionIndividual', $("#txtReligionIndividual").val());
            formData.append('NationIndividual', $("#txtNationIndividual").val());
            formData.append('StateIndividual', $("#txtStateIndividual").val());
            formData.append('PurposeIndividual', $("#txtPurposeIndividual").val());
            formData.append('AddressIndividual', $("#txtAddressIndividual").val());
            formData.append('SalutationIndividual', $("#txtSalutationIndividual").val());
            formData.append('VIPIndividual', $("#txtVIPIndividual").val());
            formData.append('ReasonIndividual', $("#txtReasonIndividual").val());
            // Note: PrefRoom/Other missing in source but present in JS save logic. Kept as is.
            formData.append('PrefRoomIndividual', $("#txtPrefRoomIndividual").val());
            formData.append('OtherIndividual', $("#txtOtherIndividual").val());
            formData.append('PassportIndividual', $("#txtPassportIndividual").val());
            formData.append('CardIndividual', $("#txtCardIndividual").val());
            formData.append('DobIndividual', $("#txtDobIndividual").val());
            formData.append('ActiveIndividual', $("#txtActiveIndividual").is(":checked"));
            formData.append('ContactIndividual', $("#txtContactIndividual").is(":checked"));
            formData.append('KeywordIndividual', $("#txtKeywordIndividual").val());
            formData.append('TaxIndividual', $("#txtTaxIndividual").val());
            formData.append('BusAddressIndividual', $("#txtBusAddressIndividual").val());
            formData.append('TelephoneIndividual', $("#txtTelephoneIndividual").val());
            formData.append('HandPhoneIndividual', $("#txtHandPhoneIndividual").val());
            formData.append('FaxIndividual', $("#txtFaxIndividual").val());
            formData.append('EmailIndividual', $("#txtEmailIndividual").val());
            formData.append('WebsiteIndividual', $("#txtWebsiteIndividual").val());
            formData.append('CompanyIndividual', $("#txtCompanyIndividual").val());
            formData.append('Company2Individual', $("#txtCompany2Individual").val());
            formData.append('BusinessTitleIndividual', $("#txtBusinessTitleIndividual").val());
            formData.append('BlackListIndividual', $("#blackListIndividual").is(":checked"));
            formData.append('BlackListReasonIndividual', $("#blackListReasonIndividual").val());
            formData.append('NoteIndividual', $("#txtNoteIndividual").val());
        }
        else if (profileTypeValue == 1 || profileTypeValue == 2 || profileTypeValue == 3) {
            formData.append('CodeCOM', $("#txtCodeCOM").val());
            formData.append('AccountCOM', $("#txtAccountCOM").val());
            formData.append('AddressCOM', $("#txtAddressCOM").val());
            formData.append('CountryCOM', $("#txtCountryCOM").val());
            formData.append('CityCOM', $("#txtCityCOM").val());
            formData.append('PostalCOM', $("#txtPostalCOM").val());
            formData.append('StateCOM', $("#txtStateCOM").val());
            formData.append('FullAccount', $("#txtCompanyCOM").val());
            formData.append('TaxCOM', $("#txtTaxCOM").val());
            formData.append('BusAddressCOM', $("#txtBusAddressCOM").val());
            formData.append('TelephoneCOM', $("#txtTelephoneCOM").val());
            formData.append('ContactNameCOM', $("#txtContactNameCOM").val());
            formData.append('EmailCOM', $("#txtEmailCOM").val());
            formData.append('WebsiteCOM', $("#txtWebsiteCOM").val());
            formData.append('HandPhoneCOM', $("#txtHandPhoneCOM").val());
            formData.append('Company2COM', $("#txtCompany2COM").val());
            formData.append('BusinessTitleCOM', $("#txtBusTitleCOM").val());
            formData.append('OwnerCOM', $("#txtOwnerCOM").val());
            formData.append('TerritoryCOM', $("#txtTerritoryCOM").val());
            formData.append('KeywordCOM', $("#txtKeywordCOM").val());
            formData.append('CompanyTypeCOM', $("#txtCompanyTypeCOM").val());
            formData.append('ARCOM', $("#txtARCOM").val());
            formData.append('CurrencyCOM', $("#txtCurrencyCOM").val());
            formData.append('SaleInChargeCOM', $("#txtSaleInChargeCOM").val());
            formData.append('MarketCOM', $("#txtMarketCOM").val());
            formData.append('ActiveCOM', $("#txtActiveCOM").is(":checked"));
            formData.append('BlackListCOM', $("#blackListCOM").is(":checked"));
            formData.append('BlackListReasonCOM', $("#blackListReasonCOM").val());
            formData.append('NoteCOM', $("#txtNoteCOM").val()); // Fixed ID typo from source (txtNotECOM -> txtNoteCOM) based on usage context
        }
        else if (profileTypeValue == 4) {
            formData.append('CodeCOM', $("#txtCodeGroup").val());
            formData.append('GroupNameGroup', $("#txtGroupNameGroup").val());
            formData.append('LanguageGruop', $("#txtLanguageGroup").val());
            formData.append('HomeAddressGroup', $("#txtHomeAddressGroup").val());
            formData.append('AddressGroup', $("#txtHomeAddressGroup").val());
            formData.append('CityGroup', $("#txtCityGroup").val());
            formData.append('PostalGroup', $("#txtPostalCodeGroup").val());
            formData.append('CountryGroup', $("#txtCountryGroup").val());
            formData.append('StateGroup', $("#txtStateGroup").val());
            formData.append('TelephoneGroup', $("#txtTelephoneGroup").val());
            formData.append('EmailGroup', $("#txtEmailGroup").val());
            formData.append('WebsiteGroup', $("#txtWebsiteGroup").val());
            formData.append('HandPhoneGroup', $("#txtHandPhoneGroup").val());
            formData.append('FaxGroup', $("#txtFaxGroup").val());
            formData.append('ContactNameGroup', $("#txtContactGroup").val());
            formData.append('CurrencyGroup', $("#txtCurrencyGroup").val());
            formData.append('VIPGroup', $("#txtVIPGroup").val()); // Careful with this ID reuse
            formData.append('VIPReason', $("#txtVIPReasonGroup").val());
            formData.append('HistoryGroup', $("#txtHistory").is(":checked"));
            formData.append('NotesGroup', $("#txtNotesGroup").val());
            formData.append('AcctContact', $("#txtContactGroup").val());
        }
        else {
            const individualValid = await checkFullName({
                fullNameSelector: '#txtFullNameContact',
                firstNameSelector: '#txtFirstNameContact',
                middleNameSelector: '#txtMiddleNameContact',
                lastNameSelector: '#txtLastContact',
                salutationSelector: '#txtSalulationContact',
                titleSelector: '#txtTitleContact',
                idForm: "#profile_contact"
            });
            if (!individualValid) return;

            formData.append('CodeContact', $("#txtCodeContact").val());
            formData.append('AccountContact', $("#txtFullNameContact").val());
            formData.append('LastNameContact', $("#txtLastContact").val());
            formData.append('FirstNameContact', $("#txtFirstNameContact").val());
            formData.append('MiddleNameContact', $("#txtMiddleNameContact").val());
            formData.append('LanguageContact', $("#txtLanguageContact").val());
            formData.append('PositionContact', $("#txtPositionContact").val());
            formData.append('DeptContact', $("#txtDeptContact").val());
            formData.append('TitleContact', $("#txtTitleContact").val());
            formData.append('SalulationContact', $("#txtSalulationContact").val());
            formData.append('AddressContact', $("#txtAddressContact").val());
            formData.append('HomeAddressContact', $("#txtHomeAddressContact").val());
            formData.append('CityContact', $("#txtCityContact").val());
            formData.append('PostalContact', $("#txtPostalCodeContact").val());
            formData.append('CountryContact', $("#txtCountryContact").val());
            formData.append('StateContact', $("#txtStateContact").val());
            formData.append('OwnerContact', $("#txtOwnerContact").val());
            formData.append('TerritoryContact', $("#txtTerritoryContact").val());
            formData.append('ARNoContact', $("#txtARNoContact").val());
            formData.append('DobContact', $("#txtDobContact").val());
            formData.append('TelephoneContact', $("#txtTelephoneContact").val());
            formData.append('FaxContact', $("#txtFaxContact").val());
            formData.append('EmailContact', $("#txtEmailContact").val());
            formData.append('WebsiteContact', $("#txtWebsiteContact").val());
            formData.append('HandPhoneContact', $("#txtHandPhoneContact").val());
        }

        $.ajax({
            url: '/Profile/SaveProfile',
            type: 'POST',
            processData: false,
            contentType: false,
            data: formData,
            success: function (res) {
                if (res.success) {
                    resetForm();
                    showToast("Success", res.message, true);
                    var form = res.type;
                    if (form == 0) applyValidationErrors([], "#profile_individual");
                    else if (form == 1 || form == 2 || form == 3) applyValidationErrors([], "#profile_com_ta_source");
                    else if (form == 4) applyValidationErrors([], "#profile_group");
                    else applyValidationErrors([], "#profile_contact");
                } else {
                    var form = res.type;
                    if (form == 0) applyValidationErrors(res.errors, "#profile_individual");
                    else if (form == 1 || form == 2 || form == 3) applyValidationErrors(res.errors, "#profile_com_ta_source");
                    else if (form == 4) applyValidationErrors(res.errors, "#profile_group");
                    else applyValidationErrors(res.errors, "#profile_contact");
                    showToast("Error", res.message, false)
                }
            }
        });
    }

    function checkFullName(options) {
        return new Promise(function (resolve, reject) {
            const { fullNameSelector, firstNameSelector, middleNameSelector, lastNameSelector, salutationSelector, titleSelector, idForm } = options;
            const $fullName = $(fullNameSelector);
            if (!$fullName.length) { resolve(true); return; }
            const input = $fullName.val().trim();
            if (input === '') { resolve(true); return; }

            $.ajax({
                url: '/Profile/FullNameChange',
                type: 'POST',
                dataType: 'json',
                headers: { "X-CSRF-TOKEN-HEADERNAME": $('input[name="__RequestVerificationToken"]').val() },
                data: { fullName: input },
                success: function (res) {
                    if (res && res.success) {
                        $fullName.val(res.fullName);
                        if (firstNameSelector) $(firstNameSelector).val(res.firstName || '');
                        if (middleNameSelector) $(middleNameSelector).val(res.middleName || '');
                        if (lastNameSelector) $(lastNameSelector).val(res.lastName || '');
                        if (salutationSelector) $(salutationSelector).val(res.salutation || '');
                        if (res.titleID && titleSelector) {
                            let select = $(titleSelector)[0]?.tomselect;
                            if (select) select.setValue(res.titleID);
                        }
                        resolve(true);
                    } else {
                        applyValidationErrors(res.errors, idForm);
                        resolve(false);
                    }
                },
                error: function () { reject(false); }
            });
        });
    }

    // Bind blurs
    $('#txtFullNameIndividual').on('blur', function () {
        checkFullName({
            fullNameSelector: '#txtFullNameIndividual',
            firstNameSelector: '#txtFirstNameIndividual',
            middleNameSelector: '#txtMiddleNameIndividual',
            lastNameSelector: '#txtLastNameIndividual',
            salutationSelector: '#txtSalutationIndividual',
            titleSelector: '#txtTitleIndividual',
            idForm: "#profile_individual"
        });
    });
    $('#txtFullNameContact').on('blur', function () {
        checkFullName({
            fullNameSelector: '#txtFullNameContact',
            firstNameSelector: '#txtFirstNameContact',
            middleNameSelector: '#txtMiddleNameContact',
            lastNameSelector: '#txtLastContact',
            salutationSelector: '#txtSalulationContact',
            titleSelector: '#txtTitleContact',
            idForm: "#profile_contact"
        });
    });


    function getAllLanguage() {
        $.ajax({
            url: '/Profile/GetAllLanguage',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtLanguageIndividual')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa danh sách options cũ
                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });


                    let select2 = $('#txtLanguageGroup')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa danh sách options cũ
                    result.forEach(item => {
                        select2.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });


                    let select3 = $('#txtLanguageContact')[0].tomselect; // Lấy instance của TomSelect
                    select3.clear(); // Xóa giá trị hiện tại
                    select3.clearOptions(); // Xóa danh sách options cũ
                    result.forEach(item => {
                        select3.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });

                }
            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách ngôn ngữ hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getAllTitle() {
        $.ajax({
            url: '/Profile/GetAllTitle',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtTitleIndividual')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });


                    let select3 = $('#txtTitleContact')[0].tomselect; // Lấy instance của TomSelect
                    select3.clear(); // Xóa giá trị hiện tại
                    select3.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select3.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });

                }
            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getAllNationality() {
        $.ajax({
            url: '/Profile/GetAllNationality',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtNationalityIndividual')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });

                }
            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getAllCountry() {
        $.ajax({
            url: '/Profile/GetAllCountry',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtCountryIndividual')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });


                    let select2 = $('#txtCountryCOM')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select2.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });


                    let select3 = $('#txtCountryGroup')[0].tomselect; // Lấy instance của TomSelect
                    select3.clear(); // Xóa giá trị hiện tại
                    select3.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select3.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });

                    let select4 = $('#txtCountryContact')[0].tomselect; // Lấy instance của TomSelect
                    select4.clear(); // Xóa giá trị hiện tại
                    select4.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select4.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });
                }
            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getAllState() {
        $.ajax({
            url: '/Profile/GetAllState',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtStateIndividual')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        // select.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                        select.addOption({ value: item.id, text: `${item.stateName}` });
                    });

                    let select2 = $('#txtStateCOM')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa tất cả option cũ
                    result.forEach(item => {
                        select2.addOption({ value: item.id, text: `${item.stateName}` });
                    });

                    let select3 = $('#txtStateGroup')[0].tomselect; // Lấy instance của TomSelect
                    select3.clear(); // Xóa giá trị hiện tại
                    select3.clearOptions(); // Xóa tất cả option cũ
                    result.forEach(item => {
                        select3.addOption({ value: item.id, text: `${item.stateName}` });
                    });

                    let select4 = $('#txtStateContact')[0].tomselect; // Lấy instance của TomSelect
                    select4.clear(); // Xóa giá trị hiện tại
                    select4.clearOptions(); // Xóa tất cả option cũ
                    result.forEach(item => {
                        select4.addOption({ value: item.id, text: `${item.stateName}` });
                    });
                }
                else {
                    let select = $('#txtStateIndividual')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    let select2 = $('#txtStateCOM')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa tất cả option cũ

                    let select3 = $('#txtStateGroup')[0].tomselect; // Lấy instance của TomSelect
                    select3.clear(); // Xóa giá trị hiện tại
                    select3.clearOptions(); // Xóa tất cả option cũ

                    let select4 = $('#txtStateContact')[0].tomselect; // Lấy instance của TomSelect
                    select4.clear(); // Xóa giá trị hiện tại
                    select4.clearOptions(); // Xóa tất cả option cũ
                }
            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getPersonInCharge2() {
        $.ajax({
            url: '/Administration/PersonInChargeData',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {

                if (result.length > 0) {
                    let select = $('#txtSaleInChargeCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });



                    // let select2 = $('#txtCurrencyGroup')[0].tomselect; // Lấy instance của TomSelect
                    // select2.clear(); // Xóa giá trị hiện tại
                    // select2.clearOptions(); // Xóa tất cả option cũ

                    // result.forEach(item => {
                    //     select2.addOption({ value: item.id, text: `${item.description}` });
                    // });

                }
                else {
                    let select = $('#txtSaleInChargeCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    // let select2 = $('#txtCurrencyGroup')[0].tomselect; // Lấy instance của TomSelect
                    // select2.clear(); // Xóa giá trị hiện tại
                    // select2.clearOptions(); // Xóa tất cả option cũ
                }

            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getAllCity() {
        $.ajax({
            url: '/Profile/GetAllCity',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtCityIndividual')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ
                    result.forEach(item => {
                        select.addOption({ value: item.code, text: `${item.code} - ${item.name}` });
                    });


                    let select2 = $('#txtCityCOM')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select2.addOption({ value: item.code, text: `${item.code} - ${item.name}` });
                    });

                    let select4 = $('#txtCityContact')[0].tomselect; // Lấy instance của TomSelect
                    select4.clear(); // Xóa giá trị hiện tại
                    select4.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select4.addOption({ value: item.code, text: `${item.code} - ${item.name}` });
                    });

                }
            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getAllVIP() {
        $.ajax({
            url: '/Profile/GetAllVIP',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtVIPIndividual')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });


                    let select2 = $('#txtVIPGroup')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select2.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });


                    select.on('change', function (value) {
                        if (!value || (Array.isArray(value) && value.length === 0)) {
                            $('#txtReasonIndividual').val('');
                            return;
                        }

                        // Nếu là single select, ép về string
                        if (Array.isArray(value)) {
                            value = value[0];
                        }

                        let option = select.options[value];
                        if (!option) return;

                        // "CODE - NAME" → lấy NAME
                        let name = option.text.replace(/^[^-]+ - /, '');

                        $('#txtReasonIndividual').val(name);
                    });
                    select2.on('change', function (value) {
                        if (!value || (Array.isArray(value) && value.length === 0)) {
                            $('#txtVIPGroup').val('');
                            return;
                        }

                        // Nếu là single select, ép về string
                        if (Array.isArray(value)) {
                            value = value[0];
                        }

                        let option = select.options[value];
                        if (!option) return;

                        // "CODE - NAME" → lấy NAME
                        let name = option.text.replace(/^[^-]+ - /, '');

                        $('#txtReasonIndividual').val(name);
                    });

                }
            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getAllOwner() {
        $.ajax({
            url: '/Profile/GetAllOwner',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtOwnerCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });


                    let select2 = $('#txtOwnerContact')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select2.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });


                }
            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getAllTerritory() {
        $.ajax({
            url: '/Profile/GetAllTerritory',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtTerritoryCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });


                    let select2 = $('#txtTerritoryContact')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select2.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });

                }
                else {
                    let select = $('#txtTerritoryCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    let select2 = $('#txtTerritoryContact')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa tất cả option cũ
                }

            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getCompanyType() {
        $.ajax({
            url: '/Profile/GetAllCompanyType',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtCompanyTypeCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ
                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.code} - ${item.name}` });
                    });

                }
                else {
                    let select = $('#txtCompanyTypeCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ
                }

            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    function getCurrency() {
        $.ajax({
            url: '/Profile/GetAllCurrency',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select2 = $('#txtCurrencyCOM')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select2.addOption({ value: item.id, text: `${item.id} - ${item.description}` });
                    });



                    let select3 = $('#txtCurrencyGroup')[0].tomselect; // Lấy instance của TomSelect
                    select3.clear(); // Xóa giá trị hiện tại
                    select3.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select3.addOption({ value: item.id, text: `${item.id} - ${item.description}` });
                    });

                }
                else {
                    let select = $('#txtCurrencyCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    let select2 = $('#txtCurrencyGroup')[0].tomselect; // Lấy instance của TomSelect
                    select2.clear(); // Xóa giá trị hiện tại
                    select2.clearOptions(); // Xóa tất cả option cũ
                }

            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }


    function getMarketType() {
        $.ajax({
            url: '/Profile/GetMarketType',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtMarketTypeCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.description}` });
                    });

                }
                else {
                    let select = $('#txtMarketTypeCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ
                }

            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }
    $('#txtMarketTypeCOM').on('change', function () {
        console.log('change');
        getMarket();
    });
    function getMarket() {
        $.ajax({
            url: '/Profile/GetMarketByFK',
            type: 'get',
            dataType: 'json',
            crossDomain: false,
            headers: { "X-CSRF-TOKEN-HEADERNAME": jQuery("input[name='__RequestVerificationToken']").val() },
            data: { marketTypeID: $('#txtMarketTypeCOM').val() },
            success: function (result) {
                if (result.length > 0) {
                    let select = $('#txtMarketCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ

                    result.forEach(item => {
                        select.addOption({ value: item.id, text: `${item.description}` });
                    });

                }
                else {
                    let select = $('#txtMarketCOM')[0].tomselect; // Lấy instance của TomSelect
                    select.clear(); // Xóa giá trị hiện tại
                    select.clearOptions(); // Xóa tất cả option cũ
                }

            },
            error: function (xhr, statusText, err) {
                if (xhr.status == 401) {
                    sessionTimeout();
                } else {
                    informBox(TOAST_STATUS.DANGER, "Lỗi tải danh sách tiêu đề hoặc bạn không có quyền tải");
                }
            }
        });
    }

    // Set va;ue tomselect
    function setTomSelectValue(selector, value, text = null) {
        const ts = tomSelectInstances[selector];
        if (!ts) return;

        if (value === null || value === undefined || value === '' || value == 0) {
            ts.clear();
            return;
        }

        // Nếu option chưa tồn tại → add
        if (!ts.options[value]) {
            ts.addOption({
                value: value,
                text: text ?? value
            });
        }

        ts.setValue(value, true);
    }

    // They are omitted in this snippet only for length, but must be present in the final file.

    function resetForm() {
        //id individual
        $("#txtCodeIndividual").val("");
        $("#txtFullNameIndividual").val("");
        $("#txtLastNameIndividual").val("");
        $("#txtFirstNameIndividual").val("");
        $("#txtMiddleNameIndividual").val("");
        let langIndividual = $('#txtLanguageIndividual')[0].tomselect;
        if (langIndividual) {
            langIndividual.clear();       // xóa value đang chọn
        }

        let titleIndividual = $('#txtTitleIndividual')[0].tomselect;
        if (titleIndividual) {
            titleIndividual.clear();
        }

        let nationalityIndividual = $('#txtNationalityIndividual')[0].tomselect;
        if (nationalityIndividual) {
            nationalityIndividual.clear();
        }

        let countryIndividual = $('#txtCountryIndividual')[0].tomselect;
        if (countryIndividual) {
            countryIndividual.clear();
        }

        let cityIndividual = $('#txtCityIndividual')[0].tomselect;
        if (cityIndividual) {
            cityIndividual.clear();
        }

        $("#txtPostalIndividual").val("");
        $("#txtReligionIndividual").val("");
        $("#txtNationIndividual").val("");
        let stateIndividual = $('#txtStateIndividual')[0].tomselect;
        if (stateIndividual) {
            stateIndividual.clear();
        }

        $("#txtPurposeIndividual").val("");
        $("#txtAddressIndividual").val("");
        $("#txtSalutationIndividual").val("");
        $("#txtVIPIndividual").val("");
        let vipIndividual = $('#txtVIPIndividual')[0].tomselect;
        if (vipIndividual) {
            vipIndividual.clear();
        }

        $("#ReasonIndividual").val("");
        $("#txtPrefRoomIndividual").val("");
        $("#txtOtherIndividual").val("");
        $("#txtPassportIndividual").val("");
        $("#txtCardIndividual").val("");
        $("#txtDobIndividual").val("");
        $("#txtKeywordIndividual").val("");
        $("#txtCompanyIndividual").val("");
        $("#txtTaxIndividual").val("");
        $("#txtBusAddressIndividual").val("");
        $("#txtTelephoneIndividual").val("");
        $("#txtHandPhoneIndividual").val("");
        $("#txtFaxIndividual").val("");
        $("#txtEmailIndividual").val("");
        $("#txtWebsiteIndividual").val("");
        $("#txtTelephtxtCompany2").val("");
        $("#txtBusinessTitleIndividual").val("");
        $("#blackListIndividual").val("");
        $("#txtNoteIndividual").val("");

        // id com
        $("#txtCodeCOM").val("");
        $("#txtAccountCOM").val("");
        $("#txtAddressCOM").val("");
        $("#txtCountryCOM").val("");
        let txtCountryCOM = $('#txtCountryCOM')[0].tomselect;
        if (txtCountryCOM) {
            txtCountryCOM.clear();
        }

        $("#txtCityCOM").val("");
        let txtCityCOM = $('#txtCityCOM')[0].tomselect;
        if (txtCityCOM) {
            txtCityCOM.clear();
        }
        $("#txtPostalCOM").val("");
        $("#txtStateCOM").val(); //
        let txtStateCOM = $('#txtStateCOM')[0].tomselect;
        if (txtStateCOM) {
            txtStateCOM.clear();
        }

        $("#txtCompanyCOM").val("");
        $("#txtTaxCOM").val("");
        $("#txtBusAddressCOM").val("");
        $("#txtTelephoneCOM").val("");
        $("#txtContactNameCOM").val("");
        $("#txtEmailCOM").val("");
        $("#txtWebsiteCOM").val("");
        $("#txtHandPhoneCOM").val("");
        $("#txtCompany2COM").val("");
        $("#txtBusTitleCOM").val("");
        $("#txtOwnerCOM").val("");
        let txtOwnerCOM = $('#txtOwnerCOM')[0].tomselect;
        if (txtOwnerCOM) {
            txtOwnerCOM.clear();
        }

        $("#txtTerritoryCOM").val("");
        let txtTerritoryCOM = $('#txtTerritoryCOM')[0].tomselect;
        if (txtTerritoryCOM) {
            txtTerritoryCOM.clear();
        }

        $("#txtKeywordCOM").val("");
        $("#txtCompanyTypeCOM").val();
        let txtCompanyTypeCOM = $('#txtCompanyTypeCOM')[0].tomselect;
        if (txtCompanyTypeCOM) {
            txtCompanyTypeCOM.clear();
        }


        $("#txtARCOM").val("");
        $("#txtCurrencyCOM").val("");
        let txtCurrencyCOM = $('#txtCurrencyCOM')[0].tomselect;
        if (txtCurrencyCOM) {
            txtCurrencyCOM.clear();
        }

        $("#txtSaleInChargeCOM").val("");//
        let txtSaleInChargeCOM = $('#txtSaleInChargeCOM')[0].tomselect;
        if (txtSaleInChargeCOM) {
            txtSaleInChargeCOM.clear();
        }

        $("#txtMarketTypeCOM").val("");
        let txtMarketTypeCOM = $('#txtMarketTypeCOM')[0].tomselect;
        if (txtMarketTypeCOM) {
            txtMarketTypeCOM.clear();
        }

        $("#txtMarketCOM").val(""); //
        let txtMarketCOM = $('#txtMarketCOM')[0].tomselect;
        if (txtMarketCOM) {
            txtMarketCOM.clear();
        }

        $("#txtActiveCOM").val("");
        $("#txtBlackListCOM").val("");
        $("#blackListCOM").val("");
        $("#txtNotECOM").val("");

        // id group
        $("#txtCodeGroup").val("");
        $("#txtGroupNameGroup").val("");
        $("#txtLanguageGroup").val("");
        let txtLanguageGroup = $('#txtLanguageGroup')[0].tomselect;
        if (txtLanguageGroup) {
            txtLanguageGroup.clear();
        }
        $("#txtHomeAddressGroup").val("");
        $("#txtAddressGroup").val("");
        $("#txtCityGroup").val("");
        $("#txtPostalCodeGroup").val("");
        $("#txtCountryGroup").val("");
        let txtCountryGroup = $('#txtCountryGroup')[0].tomselect;
        if (txtCountryGroup) {
            txtCountryGroup.clear();
        }

        $("#txtStateGroup").val("");
        let txtStateGroup = $('#txtStateGroup')[0].tomselect;
        if (txtStateGroup) {
            txtStateGroup.clear();
        }

        $("#txtTelephoneGroup").val("");
        $("#txtEmailGroup").val("");
        $("#txtWebsiteGroup").val("");
        $("#txtHandPhoneGroup").val("");
        $("#txtFaxGroup").val("");
        $("#txtContactGroup").val("");
        $("#txtCurrencyGroup").val("");
        let txtCurrencyGroup = $('#txtCurrencyGroup')[0].tomselect;
        if (txtCurrencyGroup) {
            txtCurrencyGroup.clear();
        }
        $("#txtVIPGroup").val("");
        let txtVIPGroup = $('#txtVIPGroup')[0].tomselect;
        if (txtVIPGroup) {
            txtVIPGroup.clear();
        }

        $("#txtNotesGroup").val("");
        $("#txtVIPReasonGroup").val("");
        $("#txtHistory").val("");

        // id contact
        $("#txtCodeContact").val("");
        $("#txtFullNameContact").val("");
        $("#txtLastContact").val("");
        $("#txtFirstNameContact").val("");
        $("#txtMiddleNameContact").val("");
        $("#txtLanguageContact").val("");
        let txtLanguageContact = $('#txtLanguageContact')[0].tomselect;
        if (txtLanguageContact) {
            txtLanguageContact.clear();
        }

        $("#txtPositionContact").val("");
        $("#txtDeptContact").val("");
        $("#txtTitleContact").val("");
        let txtTitleContact = $('#txtTitleContact')[0].tomselect;
        if (txtTitleContact) {
            txtTitleContact.clear();
        }
        $("#txtSalulationContact").val("");
        $("#txtAddressContact").val("");
        $("#txtHomeAddressContact").val("");
        $("#txtCityContact").val("");
        let txtCityContact = $('#txtCityContact')[0].tomselect;
        if (txtCityContact) {
            txtCityContact.clear();
        }

        $("#txtPostalCodeContact").val("");
        $("#txtCountryContact").val("");
        let txtCountryContact = $('#txtCountryContact')[0].tomselect;
        if (txtCountryContact) {
            txtCountryContact.clear();
        }

        $("#txtStateContact").val("");
        let txtStateContact = $('#txtStateContact')[0].tomselect;
        if (txtStateContact) {
            txtStateContact.clear();
        }

        $("#txtOwnerContact").val("");
        let txtOwnerContact = $('#txtOwnerContact')[0].tomselect;
        if (txtOwnerContact) {
            txtOwnerContact.clear();
        }

        $("#txtTerritoryContact").val("");
        let txtTerritoryContact = $('#txtTerritoryContact')[0].tomselect;
        if (txtTerritoryContact) {
            txtTerritoryContact.clear();
        }

        $("#txtARNoContact").val("");
        $("#txtDobContact").val("");
        $("#txtTelephoneContact").val("");
        $("#txtFaxContact").val("");
        $("#txtEmailContact").val("");
        $("#txtWebsiteContact").val("");
        $("#txtHandPhoneContact").val("");
    }

</script>
